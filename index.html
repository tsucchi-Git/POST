<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>fetch-POSTの使い方3</title>
</head>
<body>
  <!-- <h1>Fetchの使い方3</h1>
  <button onclick="navigate()">データの書込み</button> -->
</body>
  <script>
    //Var FileName='test.json';

    getMarkerData();
    function navigate(){
      //sendUserData(newUser);
    }
    
    function getMarkerData()　{
    //urlからデータを読み込む
      fetch('test2.json')
    //データを受け取って、加工・成形
      .then(response => {
        //jsonはオブジェクト（連想配列）
        return response.json()
      })
      //取得したデータは連想配列
      .then(markerList => {
        for (var i = 0; i < markerList.length; i++) {
          alert('ファイルの読み込み成功しましたよ。' + markerList[i].id + ',' + markerList[i].name + ',' +　markerList[i].file + '\n')
        //document.write(markerList[i]['id'])
        }
        //データの追加
          markerList[markerList.length].id=100;
          markerList[markerList.length].name="姫路城";
          markerList[markerList.length].file="100.png";
        //データの送信
        //sendUserData(markerList);
        
       })
    //通信にエラーが発生した場合
      .catch(error => {alert('ファイルを読み込むことができませんでした。')})
    }
    // 基本的なPOSTリクエスト
    // async function sendUserData(userData) {
    //     alert('--- 1 ---')
    //     const response = await fetch('test2.json', {
    //         method: 'POST',
    //         headers: {
    //             'Content-Type': 'application/json',
    //         },
    //     alert('--- 2 ---')
    //         body: JSON.stringify(userData)
    //     });
    //     alert('--- 3 ---')
    
    //     const result = await response.json();
    //     return result;
    // }

</script>  
</body>
</html>

















